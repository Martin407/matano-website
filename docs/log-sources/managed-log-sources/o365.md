---
title: Office 365
sidebar_position: 7
---

The Office 365 Matano managed log source lets you ingest your Microsoft Office 365 logs directly into Matano.

## Usage

Use the managed log source by specifying the `managed.type` property in your `log_source` as `O365`.

```yml
name: o365

managed:
  type: O365
  properties:
    client_id: <MY_CLIENT_ID>
    tenant_id: <MY_TENANT_ID>
```

For the tables you would like to enable from this managed log source, under a `tables/` subdirectory in your log source directory, create a file with the name `<table_name>.yml>`. For example:

```
my-matano-dir/
└── log_sources/
    └── o365/
        └── log_source.yml
        └── tables/
            └── audit.yml
```

For a complete reference on configuring log sources, including extending the table schema, see [_Log source configuration_](../configuration.md).

## Tables

The Office 365 managed log source supports the following tables:

- audit

## Ingest

### Pull (default)

Matano integrates with your Microsoft Office 365 account to automatically pull relevant logs on a regular basis (every 5 min).

To get started with the integration, specify the following properties in the log source configuration file:

```yml
managed:
  type: O365
  properties:
    client_id: <MY_CLIENT_ID>
    tenant_id: <MY_TENANT_ID>
    tenant_name: my_tenant.onmicrosoft.com # optional
```

After the first deployment, this log source will also generate a secret in AWS secret's manager to store secrets related to this integration.

#### Secret

To finish onboarding the log source, populate the `client_secret` key in the secret generated by Matano in AWS Secrets Manager, with the value from your OAuth app.

## Schema

O365 data is normalized to ECS fields. Custom fields are normalized into the `o365` field. You can view the [complete mapping][1] to see the full schema.

[1]: https://github.com/matanolabs/matano/blob/main/data/managed/log_sources/o365/tables/audit.yml