"use strict";(self.webpackChunk_matano_website=self.webpackChunk_matano_website||[]).push([[1360],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=c(n),m=o,g=d["".concat(l,".").concat(m)]||d[m]||u[m]||a;return n?r.createElement(g,s(s({ref:t},p),{},{components:n})):r.createElement(g,s({ref:t},p))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,s=new Array(a);s[0]=d;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:o,s[1]=i;for(var c=2;c<a;c++)s[c]=n[c];return r.createElement.apply(null,s)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},27259:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var r=n(87462),o=(n(67294),n(3905));const a={title:"Amazon S3 Inventory Reports",sidebar_label:"Amazon S3 Inventory Reports",sidebar_position:3},s=void 0,i={unversionedId:"log-sources/managed-log-sources/aws/s3-inventory-report",id:"log-sources/managed-log-sources/aws/s3-inventory-report",title:"Amazon S3 Inventory Reports",description:"The Amazon S3 Inventory Reports Matano managed log source lets you ingest your S3 inventory reports directly into Matano.",source:"@site/docs/log-sources/managed-log-sources/aws/s3-inventory-report.md",sourceDirName:"log-sources/managed-log-sources/aws",slug:"/log-sources/managed-log-sources/aws/s3-inventory-report",permalink:"/docs/log-sources/managed-log-sources/aws/s3-inventory-report",draft:!1,editUrl:"https://github.com/matanolabs/matano-website/tree/main/website/docs/log-sources/managed-log-sources/aws/s3-inventory-report.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"Amazon S3 Inventory Reports",sidebar_label:"Amazon S3 Inventory Reports",sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Amazon S3 Access",permalink:"/docs/log-sources/managed-log-sources/aws/amazon-s3-server-access-logs"},next:{title:"Amazon Inspector",permalink:"/docs/log-sources/managed-log-sources/aws/amazon-inspector"}},l={},c=[{value:"Usage",id:"usage",level:2},{value:"Tables",id:"tables",level:2},{value:"Ingest",id:"ingest",level:2},{value:"S3",id:"s3",level:3},{value:"Format",id:"format",level:4},{value:"Specifying CSV headers",id:"specifying-csv-headers",level:4},{value:"Schema",id:"schema",level:2},{value:"Notes",id:"notes",level:2}],p={toc:c};function u(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"The Amazon S3 Inventory Reports Matano managed log source lets you ingest your S3 inventory reports directly into Matano."),(0,o.kt)("p",null,"Amazon S3 Inventory Reports contain a full listing of every object in an S3 bucket."),(0,o.kt)("h2",{id:"usage"},"Usage"),(0,o.kt)("p",null,"Use the managed log source by specifying the ",(0,o.kt)("inlineCode",{parentName:"p"},"managed.type")," property in your ",(0,o.kt)("inlineCode",{parentName:"p"},"log_source")," as ",(0,o.kt)("inlineCode",{parentName:"p"},"AWS_S3INVENTORY"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yml"},'name: "aws_s3inventory"\n\nmanaged:\n  type: "AWS_S3INVENTORY"\n')),(0,o.kt)("h2",{id:"tables"},"Tables"),(0,o.kt)("p",null,"The S3 inventory reports managed log source supports a single table containing S3 inventory reports."),(0,o.kt)("h2",{id:"ingest"},"Ingest"),(0,o.kt)("h3",{id:"s3"},"S3"),(0,o.kt)("p",null,"S3 server inventory reports are always delivered to S3 buckets. You can provide the S3 bucket you are using for delivery to Matano by using the ",(0,o.kt)("inlineCode",{parentName:"p"},"ingest.s3_source")," configuration in your ",(0,o.kt)("inlineCode",{parentName:"p"},"log_source.yml")," (Bring your own bucket)."),(0,o.kt)("h4",{id:"format"},"Format"),(0,o.kt)("p",null,"Matano only supports the ",(0,o.kt)("strong",{parentName:"p"},"CSV")," format for Amazon S3 inventory reports."),(0,o.kt)("h4",{id:"specifying-csv-headers"},"Specifying CSV headers"),(0,o.kt)("p",null,"Because Amazon S3 inventory reports allow you to configure which fields are present in the report, you must specify the header format for your configuration."),(0,o.kt)("p",null,"To determine the header format for S3 inventory reports, access an existing delivery and locate the ",(0,o.kt)("inlineCode",{parentName:"p"},"manifest.json")," file for the delivery. The file will contain the CSV headers in the ",(0,o.kt)("inlineCode",{parentName:"p"},"fileSchema")," key. Add the list of strings in that order to your ",(0,o.kt)("inlineCode",{parentName:"p"},"log_source.yml")," under ",(0,o.kt)("inlineCode",{parentName:"p"},"ingest.csv_headers"),"."),(0,o.kt)("p",null,"For example, if your ",(0,o.kt)("inlineCode",{parentName:"p"},"manifest.json")," is as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  ...\n  "fileSchema" : "Bucket, Key, Size, LastModifiedDate, ETag, StorageClass, IsMultipartUploaded, ReplicationStatus, EncryptionStatus, ObjectLockRetainUntilDate, ObjectLockMode, ObjectLockLegalHoldStatus, IntelligentTieringAccessTier, BucketKeyStatus, ChecksumAlgorithm"\n}\n')),(0,o.kt)("p",null,"You would specify the following in your ",(0,o.kt)("inlineCode",{parentName:"p"},"log_source.yml")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yml"},'# log_source.yml\nname: aws_s3inventory\nmanaged:\n  type: aws_s3inventory\n\ningest:\n  csv_headers: ["Bucket", "Key", "Size", "LastModifiedDate", "ETag", "StorageClass", "IsMultipartUploaded", "ReplicationStatus", "EncryptionStatus",  "ObjectLockRetainUntilDate", "ObjectLockMode", "ObjectLockLegalHoldStatus", "IntelligentTieringAccessTier", "BucketKeyStatus", "ChecksumAlgorithm"]\n')),(0,o.kt)("h2",{id:"schema"},"Schema"),(0,o.kt)("p",null,"S3 Inventory report data is normalized to ECS fields. Custom fields are normalized into the ",(0,o.kt)("inlineCode",{parentName:"p"},"aws.s3inventory")," field. You can view the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/matanolabs/matano/blob/main/data/managed/log_sources/aws_s3inventory/log_source.yml"},"complete mapping")," to see the full schema."),(0,o.kt)("h2",{id:"notes"},"Notes"),(0,o.kt)("p",null,"S3 inventory reports are delivered hourly or weekly. When querying S3 inventory report data, make sure to add a constraint on the ",(0,o.kt)("inlineCode",{parentName:"p"},"ts")," column (partition) to ensure that you are only accessing data for a specific report."))}u.isMDXComponent=!0}}]);