"use strict";(self.webpackChunk_matano_website=self.webpackChunk_matano_website||[]).push([[3664],{3905:(e,t,r)=>{r.d(t,{Zo:()=>d,kt:()=>m});var a=r(7294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var s=a.createContext({}),c=function(e){var t=a.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},d=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=c(r),m=n,g=p["".concat(s,".").concat(m)]||p[m]||u[m]||o;return r?a.createElement(g,i(i({ref:t},d),{},{components:r})):a.createElement(g,i({ref:t},d))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var c=2;c<o;c++)i[c]=r[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}p.displayName="MDXCreateElement"},7714:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var a=r(7462),n=(r(7294),r(3905));const o={title:"Crowdstrike Falcon Data Replicator",sidebar_label:"Falcon Data Replicator",sidebar_position:2},i=void 0,l={unversionedId:"log-sources/managed/crowdstrike/fdr",id:"log-sources/managed/crowdstrike/fdr",title:"Crowdstrike Falcon Data Replicator",description:"The Crowdstrike managed log source lets you ingest your Crowdstrike FDR logs (data) directly into Matano and synchronize enrichment tables supported by the replicator (e.g. appinfo, aidmaster, etc.)",source:"@site/docs/log-sources/managed/crowdstrike/fdr.md",sourceDirName:"log-sources/managed/crowdstrike",slug:"/log-sources/managed/crowdstrike/fdr",permalink:"/docs/log-sources/managed/crowdstrike/fdr",draft:!1,editUrl:"https://github.com/matanolabs/matano-website/tree/main/website/docs/log-sources/managed/crowdstrike/fdr.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Crowdstrike Falcon Data Replicator",sidebar_label:"Falcon Data Replicator",sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Falcon",permalink:"/docs/log-sources/managed/crowdstrike/falcon"},next:{title:"Duo",permalink:"/docs/log-sources/managed/duo"}},s={},c=[{value:"Usage",id:"usage",level:2},{value:"Tables",id:"tables",level:2},{value:"Ingest",id:"ingest",level:2},{value:"S3 (default)",id:"s3-default",level:3},{value:"S3 Path scheme to table:",id:"s3-path-scheme-to-table",level:4},{value:"Schema",id:"schema",level:2}],d={toc:c};function u(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"The Crowdstrike managed log source lets you ingest your Crowdstrike FDR logs (data) directly into Matano and synchronize enrichment tables supported by the replicator (e.g. appinfo, aidmaster, etc.)"),(0,n.kt)("p",null,"The CrowdStrike Falcon Data Replicator (FDR) allows CrowdStrike users to replicate FDR data from CrowdStrike managed S3 buckets. CrowdStrike writes notification events to a CrowdStrike managed SQS queue when new data is available in S3."),(0,n.kt)("h2",{id:"usage"},"Usage"),(0,n.kt)("p",null,"Use the managed log source by specifying the ",(0,n.kt)("inlineCode",{parentName:"p"},"managed.type")," property in your ",(0,n.kt)("inlineCode",{parentName:"p"},"log_source.yml")," as ",(0,n.kt)("inlineCode",{parentName:"p"},"CROWDSTRIKE"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-yml"},'name: "crowdstrike"\n\nmanaged:\n  type: "CROWDSTRIKE"\n')),(0,n.kt)("p",null,"Then create tables for each of the Crowdstrike log types you want to ingest. For example, if you want to ingest FDR data logs, create table file(s) like so:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre"},"my-matano-dir/\n\u2514\u2500\u2500 log_sources/\n    \u2514\u2500\u2500 crowdstrike/\n        \u2514\u2500\u2500 log_source.yml\n        \u2514\u2500\u2500 tables/\n            \u2514\u2500\u2500 fdr.yml\n            \u2514\u2500\u2500 ...\n")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-yml"},'# log_sources/suricata/tables/fdr.yml\nname: "fdr"\n')),(0,n.kt)("p",null,"For a complete reference on configuring log sources, including extending the table schema, see ",(0,n.kt)("a",{parentName:"p",href:"/docs/log-sources/configuration"},(0,n.kt)("em",{parentName:"a"},"Log source configuration")),"."),(0,n.kt)("h2",{id:"tables"},"Tables"),(0,n.kt)("p",null,"The Crowdstrike managed log source supports the following tables:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"fdr",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"Primary events that come with the Falcon Insight XDR subscription or the Falcon FileVantage subscription."),(0,n.kt)("li",{parentName:"ul"},"Describe individual actions taking place on your hosts. This includes everything from user logins to malware being executed. Load these events into your Matano security lake to power investigations and enhanced threat hunting for your environment.")))),(0,n.kt)("h2",{id:"ingest"},"Ingest"),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"To use Matano with Crowdstrike FDR, you must configure the FDR tool to replicate the data to the default ",(0,n.kt)("a",{parentName:"strong",href:"/docs/log-sources/ingestion#using-the-matano-provided-sources-bucket"},"Matano source bucket")," or a ",(0,n.kt)("a",{parentName:"strong",href:"/docs/log-sources/ingestion#bringing-your-own-bucket"},"custom self-managed S3 bucket"),".")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Note:")," Matano does not currently support consuming SQS notifications directly from the CrowdStrike managed SQS queue."),(0,n.kt)("h3",{id:"s3-default"},"S3 (default)"),(0,n.kt)("p",null,"For a log source named ",(0,n.kt)("inlineCode",{parentName:"p"},"crowdstrike"),", a file under the path ",(0,n.kt)("inlineCode",{parentName:"p"},"crowdstrike/data/afe3c55a-8b05-4ac7-be76-b6fda08af95d/logs.json.gz")," will be routed to the ",(0,n.kt)("inlineCode",{parentName:"p"},"fdr")," (crowdstrike_fdr) table."),(0,n.kt)("h4",{id:"s3-path-scheme-to-table"},"S3 Path scheme to table:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"*data/*")," -> ",(0,n.kt)("strong",{parentName:"li"},"fdr"))),(0,n.kt)("h2",{id:"schema"},"Schema"),(0,n.kt)("p",null,"Crowdstrike FDR data is normalized to ECS fields. You can view the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/matanolabs/matano/blob/main/data/managed/log_sources/crowdstrike/tables/fdr.yml"},"complete mappings")," to see the full schemas."))}u.isMDXComponent=!0}}]);