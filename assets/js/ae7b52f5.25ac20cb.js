"use strict";(self.webpackChunk_matano_website=self.webpackChunk_matano_website||[]).push([[3233],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>g});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=c(n),g=r,m=p["".concat(l,".").concat(g)]||p[g]||u[g]||o;return n?a.createElement(m,i(i({ref:t},d),{},{components:n})):a.createElement(m,i({ref:t},d))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var c=2;c<o;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},77924:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var a=n(87462),r=(n(67294),n(3905)),o=n(34735);const i={title:"Adding Crowdstrike Support to Matano",authors:"shaeq",keywords:["crowdstrike","falcon","endpoint security","network","hosts"],image:"./sg.png"},s=void 0,l={permalink:"/blog/2022/12/28/crowdstrike-support",editUrl:"https://github.com/matanolabs/matano-website/tree/main/website/blog/2022-12-28-crowdstrike-support/index.md",source:"@site/blog/2022-12-28-crowdstrike-support/index.md",title:"Adding Crowdstrike Support to Matano",description:"We're excited to announce that Matano now supports managed log sources from",date:"2022-12-28T00:00:00.000Z",formattedDate:"December 28, 2022",tags:[],readingTime:3.31,hasTruncateMarker:!0,authors:[{name:"Shaeq Ahmed",email:"shaeq@matano.dev",key:"shaeq"}],frontMatter:{title:"Adding Crowdstrike Support to Matano",authors:"shaeq",keywords:["crowdstrike","falcon","endpoint security","network","hosts"],image:"./sg.png"},nextItem:{title:"Introducing enrichment tables and threat intelligence",permalink:"/blog/2022/12/23/enrichment-tables"}},c={image:n(75688).Z,authorsImageUrls:[void 0]},d=[{value:"What&#39;s new",id:"whats-new",level:2},{value:"Use Cases",id:"use-cases",level:2},{value:"How it works",id:"how-it-works",level:2},{value:"Crowdstrike Falcon &amp; FDR",id:"crowdstrike-falcon--fdr",level:3},{value:"Getting started",id:"getting-started",level:2}],u={toc:d};function p(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("head",null,(0,r.kt)("meta",{name:"twitter:card",content:"summary_large_image"}),(0,r.kt)("meta",{name:"twitter:creator",content:"@AhmedShaeq"})),(0,r.kt)("p",null,"We're excited to announce that Matano now supports managed log sources from\nCrowdstrike. This means that you can easily ingest and analyze your endpoint\nsecurity logs from Crowdstrike Falcon and Crowdstrike Falcon Data Replicator\n(FDR) logs into your Matano security lake without having to define any\nschemas or parsers."),(0,r.kt)("br",null),(0,r.kt)("div",{align:"center"},(0,r.kt)("img",{className:"mtn-blog-sq-img",src:o.Z})),(0,r.kt)("br",null),(0,r.kt)("h2",{id:"whats-new"},"What's new"),(0,r.kt)("p",null,"Using Matano you can efficiently process & store petabytes of Crowdstrike logs &\ndetection alerts into a normalized security data lake (S3) in your AWS account\nfor advanced\ncorrelation & analysis during investigations."),(0,r.kt)("p",null,"As of today, Matano supports ingesting both Crowdstrike Falcon (from the\nStreaming API - SIEM Collector) logs and Crowdstrike Falcon Data Replicator\n(FDR) logs via S3 ingestion, using an existing or Matano provided source bucket."),(0,r.kt)("h2",{id:"use-cases"},"Use Cases"),(0,r.kt)("p",null,"Matano lets you cost-effectively query historical data using SQL (via\nAthena, Snowflake, ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/matanolabs/matano#query-engines"},"or any compatible engine"),"), perform bulk search for IOCs,\nand even create realtime\ndetections-as-code for your logs using Python!"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Correlation & Search")," - By capturing events from Crowdstrike Falcon along\nwith other\nsecurity data & normalizing all fields to ECS, Matano helps you correlate\nacross log sources, analyze DNS events, and search for IOCs.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Investigations & Long-Term Storage")," - Efficiently store\npetabytes of logs from Falcon\nData Replicator (FDR) in\nyour structured Matano security data lake to help with investigations and enable\nanalysis\nusing SQL.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Realtime Detection & Alerting")," Write detection rules as code in Matano to\nalert on malicious user and network activity in host and endpoint logs\nfrom\nCrowdstrike in realtime. Our Python-based\ndetection format allow you to build\nhighly customizable and effective rules to alert on potential threats."))),(0,r.kt)("h2",{id:"how-it-works"},"How it works"),(0,r.kt)("h3",{id:"crowdstrike-falcon--fdr"},"Crowdstrike Falcon & FDR"),(0,r.kt)("p",null,"Let's walk through how to ingest Crowdstrike Falcon logs into Matano. We can\nsimply point Matano at a bucket containing logs delivered from the SIEM\nCollector and start ingesting data, with a simple configuration file:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yml"},'# log_source.yml\nname: crowdstrike_falcon\n\nmanaged:\n  type: "CROWDSTRIKE_FALCON"\n\ningest:\n  s3_source:\n    bucket_name: "my-bucket"\n    key_prefix: "my/key/prefix"\n')),(0,r.kt)("p",null,"Deploying Matano with this configuration will create a Matano table named\n",(0,r.kt)("inlineCode",{parentName:"p"},"crowdstrike_falcon")," that you can query using SQL (with AWS Athena) and write\nrealtime detections on."),(0,r.kt)("p",null,"The schema is fully normalized to ECS so we easily do queries like\nsearching on\nrelated IPs or checking if an event is a failure, without remebering\nthe Crowdstrike specific fields."),(0,r.kt)("p",null,"Here's an example Athena query where we check for the latest events that are\nrelated to a failure:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"select message,\n       crowdstrike.event,\n       crowdstrike.metadata,\n       related.hosts\nfrom   matano.crowdstrike_falcon\nwhere  ts > current_timestamp - interval '7' day\n       and event.outcome = 'failure' \n")),(0,r.kt)("p",null,"We can also write Python detections that will run on realtime on each incoming\nCrowdstrike event, and optionally create an alert. Here is an example that\ndetects services that start a vulnerable version of Microsoft Remote Desktop\nProtocol (RDP) by using the Crowdstrike\nFDR logs:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'# port for vulnerable RDP\nvuln_rdp_port = 3389\n\n# servers known to be safe\nsafe_servers = ["192.168.1.10", "10.0.0.1"]\n\ndef detect(r):\n  return (\n    "network" in r.deepget("event.category", [])\n    and "start" in r.deepget("event.type", [])\n    and r.deepget("event.outcome") == "success"\n    and r.deepget("source.port") == vuln_rdp_port\n    and r.deepget("observer.ip") not in safe_servers\n  )\n')),(0,r.kt)("p",null,"Note that this detection has been written entirely against ECS normalized\nfields, without any\nmention of the corresponding Crowdstrike event types ",(0,r.kt)("inlineCode",{parentName:"p"},"NetworkListionIpv4")," and\n",(0,r.kt)("inlineCode",{parentName:"p"},"NetworkListionIpv6")," in the original event."),(0,r.kt)("p",null,"By using standardized ECS fields,\nand an open source\nlanguage such as Python, Matano helps you express your detection rules in a\ncompletely vendor-neutral way that is portable across log sources and tools!"),(0,r.kt)("h2",{id:"getting-started"},"Getting started"),(0,r.kt)("p",null,"We're excited to add support for Crowdstrike Falcon and Crowdstrike Falcon Data\nReplicator (FDR) logs to Matano, making it easy for you to ingest and analyze\nyour endpoint logs."),(0,r.kt)("p",null,"You can start using the Crowdstrike managed log sources today. Follow the ",(0,r.kt)("a",{parentName:"p",href:"/docs/getting-started"},"steps")," to get started with Matano and take a look at the ",(0,r.kt)("a",{parentName:"p",href:"/docs/log-sources/managed-log-sources/crowdstrike"},"Crowdstrike")," documentation."),(0,r.kt)("p",null,"Happy threat hunting! \ud83e\udd85"))}p.isMDXComponent=!0},34735:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/sg-f2bf730a9c677fbd9017e1d956bf33da.png"},75688:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/sg-f2bf730a9c677fbd9017e1d956bf33da.png"}}]);