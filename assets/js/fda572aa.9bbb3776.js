"use strict";(self.webpackChunk_matano_website=self.webpackChunk_matano_website||[]).push([[8717],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>g});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},u=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(a),g=r,m=d["".concat(l,".").concat(g)]||d[g]||p[g]||o;return a?n.createElement(m,i(i({ref:t},u),{},{components:a})):n.createElement(m,i({ref:t},u))}));function g(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var c=2;c<o;c++)i[c]=a[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},13097:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>u});var n=a(87462),r=(a(67294),a(3905)),o=a(37185);const i={title:"Adding Suricata Support to Matano",authors:"shaeq",keywords:["suricata","falcon","network security","network","hosts","nids","ids","nips","ips"],image:"./sg.png"},s=void 0,l={permalink:"/blog/2023/01/12/suricata-support",editUrl:"https://github.com/matanolabs/matano-website/tree/main/website/blog/2023-01-12-suricata-support/index.md",source:"@site/blog/2023-01-12-suricata-support/index.md",title:"Adding Suricata Support to Matano",description:"We're excited to announce that Matano now supports managed log sources from Suricata. This means that you can easily ingest and analyze your network activity logs and alerts from Suricata into your Matano security lake without having to define any schemas or parsers.",date:"2023-01-12T00:00:00.000Z",formattedDate:"January 12, 2023",tags:[],readingTime:3,hasTruncateMarker:!0,authors:[{name:"Shaeq Ahmed",email:"shaeq@matano.dev",key:"shaeq"}],frontMatter:{title:"Adding Suricata Support to Matano",authors:"shaeq",keywords:["suricata","falcon","network security","network","hosts","nids","ids","nips","ips"],image:"./sg.png"},nextItem:{title:"Adding Crowdstrike Support to Matano",permalink:"/blog/2022/12/28/crowdstrike-support"}},c={image:a(16427).Z,authorsImageUrls:[void 0]},u=[{value:"What&#39;s new",id:"whats-new",level:2},{value:"Use Cases",id:"use-cases",level:2},{value:"How it works",id:"how-it-works",level:2},{value:"Suricata",id:"suricata",level:3},{value:"Getting started",id:"getting-started",level:2}],p={toc:u};function d(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("head",null,(0,r.kt)("meta",{name:"twitter:card",content:"summary_large_image"}),(0,r.kt)("meta",{name:"twitter:creator",content:"@AhmedShaeq"})),(0,r.kt)("p",null,"We're excited to announce that Matano now supports managed log sources from Suricata. This means that you can easily ingest and analyze your network activity logs and alerts from Suricata into your Matano security lake without having to define any schemas or parsers."),(0,r.kt)("br",null),(0,r.kt)("div",{align:"center"},(0,r.kt)("img",{className:"mtn-blog-sq-img",src:o.Z})),(0,r.kt)("br",null),(0,r.kt)("h2",{id:"whats-new"},"What's new"),(0,r.kt)("p",null,"Using Matano you can efficiently process & store petabytes of Suricata logs & alerts into a normalized security data lake (S3) in your AWS account for context during investigations."),(0,r.kt)("p",null,"As of today, Matano supports ingesting both Suricata network logs and alerts via S3 ingestion, using an existing or Matano provided source bucket."),(0,r.kt)("h2",{id:"use-cases"},"Use Cases"),(0,r.kt)("p",null,"Suricata is a popular open source NIDS/NIPS tools that produces logs/alerts that can help provide a geographical breakdown of incoming and outgoing network traffic in an organization as well as insight into malicious activity."),(0,r.kt)("p",null,"Matano lets you cost-effectively query historical data using SQL (via\nAthena, Snowflake, ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/matanolabs/matano#query-engines"},"or any compatible engine"),"), perform bulk search for IOCs,\nand even create realtime\ndetections-as-code for your logs using Python!"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Network forensics and incident response")," - Analyze network traffic by querying Suricata logs and alerts using SQL. Identify known/unknown malware and malicious IPs & domains associated with an attack with the ability to search against months of logs cost-effectively retained in object storage.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Correlation & Search")," - By capturing events from Suricata along with other security data & normalizing all fields to ECS, Matano helps you correlate across logs and alerts, and search for IOCs. For example, the network community ID fingerprint can be used to correlate network activity with endpoint logs coming from Zeek."))),(0,r.kt)("h2",{id:"how-it-works"},"How it works"),(0,r.kt)("h3",{id:"suricata"},"Suricata"),(0,r.kt)("p",null,"Let's walk through how to ingest Suricata logs into Matano. We can\nsimply point Matano at a bucket containing logs delivered from the SIEM\nCollector and start ingesting data, with a simple configuration file for the log source:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yml"},'# log_source.yml\nname: suricata\n\nmanaged:\n  type: "SURICATA"\n\ningest:\n  s3_source:\n    bucket_name: "my-bucket"\n    key_prefix: "my/key/prefix"\n')),(0,r.kt)("p",null,"And a configuration file to setup the main suricata table (suricata_eve) for EVE JSON logs & alerts:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yml"},"# tables/eve.yml\nname: eve\n")),(0,r.kt)("p",null,"Deploying Matano with this configuration will create a Matano table named\n",(0,r.kt)("inlineCode",{parentName:"p"},"suricata_eve")," that you can query using SQL (with AWS Athena) and write\nrealtime detections against using Python."),(0,r.kt)("p",null,"The schema is fully normalized to ECS so we easily do queries like\nsearching on\nrelated IPs or checking if an event is a failure, without remebering\nthe Suricata specific fields."),(0,r.kt)("p",null,"Here's an example Athena query where we inspect the distribution of events in the last week by event type:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"select   suricata.eve.event_type,\n         event.type as ecs_event_type,\n         count(*) as count\nfrom     matano.suricata_eve\nwhere    ts > current_timestamp - interval '7' day\ngroup by event.type, suricata.eve.event_type\n")),(0,r.kt)("p",null,"As another example, here is a search for all unique IPs in events pertaining to blocked/denied traffic in the past day."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sql"},"select distinct related.ip\nfrom   matano.suricata_eve\nwhere  contains(event.type, 'denied')\n       and ts > current_timestamp - interval '1' day\n")),(0,r.kt)("p",null,"By using standardized ECS fields,\nand an open source language such as Python for detections, Matano helps you express your detection rules and threat hunting logic in a vendor-neutral way that is to port across log sources and tools!"),(0,r.kt)("h2",{id:"getting-started"},"Getting started"),(0,r.kt)("p",null,"We're excited to add support for Suricata logs to Matano, making it easy for you to ingest and analyze your network IDS/IPS logs."),(0,r.kt)("p",null,"You can start using the Suricata managed log sources today. Follow the ",(0,r.kt)("a",{parentName:"p",href:"/docs/getting-started"},"steps")," to get started with Matano and take a look at the ",(0,r.kt)("a",{parentName:"p",href:"/docs/log-sources/managed-log-sources/suricata"},"Suricata")," documentation."))}d.isMDXComponent=!0},37185:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/sg-ad805d70aeb166cc30a7599a5905b637.png"},16427:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/sg-ad805d70aeb166cc30a7599a5905b637.png"}}]);